<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© ÙˆØ¨Ù†Ø§Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©</title>
    <style>
        /* Ù†ÙØ³ Ø§Ù„Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©... */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 0;
            padding: 10px;
            line-height: 1.6;
            color: #333;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 10px auto;
            background-color: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            color: white;
            padding: 20px 15px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 22px;
            margin-bottom: 8px;
        }
        
        .header p {
            font-size: 14px;
            opacity: 0.9;
        }
        
        .tabs {
            display: flex;
            background: #34495e;
            border-bottom: 1px solid #2c3e50;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: none;
        }
        
        .tabs::-webkit-scrollbar {
            display: none;
        }
        
        .tab {
            padding: 12px 18px;
            cursor: pointer;
            color: white;
            font-weight: bold;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
            white-space: nowrap;
            flex-shrink: 0;
            font-size: 14px;
        }
        
        .tab:hover {
            background: #2c3e50;
        }
        
        .tab.active {
            background: #2c3e50;
            border-bottom: 3px solid #3498db;
        }
        
        .tab-content {
            display: none;
            padding: 15px;
            min-height: 400px;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .form-section {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            border-right: 4px solid #3498db;
        }
        
        .form-section h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 1px solid #ddd;
            font-size: 18px;
        }
        
        .form-section h4 {
            font-size: 16px;
            margin: 15px 0 10px 0;
            color: #2c3e50;
        }
        
        .form-row {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }
        
        .form-group {
            flex: 1;
            margin-bottom: 15px;
            min-width: 100%;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: bold;
            color: #2c3e50;
            font-size: 14px;
        }
        
        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            transition: all 0.3s;
            -webkit-appearance: none;
            appearance: none;
        }
        
        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            border-color: #3498db;
            box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
            outline: none;
        }
        
        .form-group textarea {
            min-height: 100px;
            resize: vertical;
        }
        
        .options-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 12px;
            margin-bottom: 15px;
        }
        
        .question-card {
            background: white;
            border: 1px solid #e1e8ed;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            transition: all 0.3s;
        }
        
        .question-card:hover {
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transform: translateY(-2px);
        }
        
        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 12px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .question-header h4 {
            font-size: 16px;
            margin: 0;
        }
        
        .question-actions {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }
        
        button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 14px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s;
            min-height: 48px;
            touch-action: manipulation;
            -webkit-tap-highlight-color: transparent;
        }
        
        button:hover, button:active {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        button:disabled {
            background-color: #bdc3c7;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .btn-success {
            background-color: #2ecc71;
        }
        
        .btn-success:hover, .btn-success:active {
            background-color: #27ae60;
        }
        
        .btn-warning {
            background-color: #f39c12;
        }
        
        .btn-warning:hover, .btn-warning:active {
            background-color: #e67e22;
        }
        
        .btn-danger {
            background-color: #e74c3c;
        }
        
        .btn-danger:hover, .btn-danger:active {
            background-color: #c0392b;
        }
        
        .btn-info {
            background-color: #17a2b8;
        }
        
        .btn-info:hover, .btn-info:active {
            background-color: #138496;
        }
        
        .center-buttons {
            text-align: center;
            margin-top: 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .center-buttons button {
            width: 100%;
        }
        
        .quiz-container {
            background: white;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .quiz-question {
            margin-bottom: 25px;
            padding: 20px;
            border: 1px solid #e1e8ed;
            border-radius: 8px;
            background: #f8f9fa;
        }
        
        .question-text {
            font-size: 16px;
            margin-bottom: 15px;
            color: #2c3e50;
            font-weight: bold;
            line-height: 1.5;
        }
        
        .quiz-option {
            margin: 10px 0;
            padding: 14px;
            background: white;
            border-radius: 8px;
            border: 2px solid #ddd;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            cursor: pointer;
            min-height: 48px;
            touch-action: manipulation;
        }
        
        .quiz-option:hover, .quiz-option:active {
            background: #e8f4fc;
            border-color: #3498db;
        }
        
        .quiz-option input {
            margin-left: 10px;
            margin-right: 10px;
            width: 20px;
            height: 20px;
            cursor: pointer;
        }
        
        .option-text {
            flex-grow: 1;
            font-size: 15px;
        }
        
        .progress-container {
            background: #ecf0f1;
            border-radius: 8px;
            margin: 15px 0;
            height: 10px;
        }
        
        .progress-bar {
            height: 100%;
            background: linear-gradient(135deg, #3498db 0%, #2c3e50 100%);
            border-radius: 8px;
            width: 0%;
            transition: width 0.5s;
        }
        
        .progress-text {
            text-align: center;
            margin-top: 10px;
            font-size: 13px;
            color: #7f8c8d;
        }
        
        .score-card {
            background: linear-gradient(135deg, #1a5276 0%, #154360 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .score {
            font-size: 36px;
            font-weight: bold;
            margin: 12px 0;
        }
        
        .grade {
            font-size: 20px;
            margin: 8px 0;
        }
        
        .student-info {
            font-size: 16px;
            margin: 8px 0;
            color: #f1c40f;
        }
        
        .questions-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
            margin-top: 15px;
        }
        
        .preview-card {
            background: white;
            border: 1px solid #e1e8ed;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .preview-card h4 {
            color: #2c3e50;
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 1px solid #eee;
            font-size: 16px;
        }
        
        .correct-option {
            background: #d4edda;
            border: 1px solid #c3e6cb;
        }
        
        .code-block {
            background: #2c3e50;
            color: white;
            padding: 15px;
            border-radius: 5px;
            font-family: monospace;
            white-space: pre-wrap;
            margin: 15px 0;
            overflow-x: auto;
            max-height: 300px;
            overflow-y: auto;
            font-size: 12px;
        }
        
        .empty-state {
            text-align: center;
            padding: 30px 15px;
            color: #7f8c8d;
        }
        
        .empty-state i {
            font-size: 40px;
            margin-bottom: 12px;
            display: block;
        }
        
        .alert {
            padding: 12px;
            border-radius: 5px;
            margin: 12px 0;
            font-weight: bold;
            font-size: 14px;
        }
        
        .alert-error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .alert-success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .timer {
            font-size: 16px;
            font-weight: bold;
            color: #e74c3c;
            text-align: center;
            margin: 12px 0;
            padding: 12px;
            background: #fff;
            border-radius: 8px;
            border: 2px solid #e74c3c;
        }
        
        .teacher-signature {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            border-radius: 15px;
            font-size: 16px;
            color: white;
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
            text-align: center;
            line-height: 1.6;
            margin: 20px auto;
            width: 100%;
            max-width: 100%;
            position: relative;
            overflow: hidden;
        }
        
        .teacher-signature::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: shimmer 3s infinite;
        }
        
        @keyframes shimmer {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .teacher-signature .school-name {
            font-size: 22px;
            font-weight: bold;
            margin-bottom: 10px;
            position: relative;
            z-index: 1;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
            letter-spacing: 1px;
        }
        
        .teacher-signature .school-message {
            font-size: 14px;
            opacity: 0.95;
            position: relative;
            z-index: 1;
            line-height: 1.8;
            font-style: italic;
        }
        
        /* ØªØ­Ø³ÙŠÙ† Ø§Ù„Ù€ checkboxes Ù„Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ */
        .form-group label {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            padding: 10px;
            border-radius: 5px;
            transition: background 0.2s;
            -webkit-tap-highlight-color: transparent;
        }
        
        .form-group label:hover {
            background: rgba(52, 152, 219, 0.1);
        }
        
        .form-group label input[type="checkbox"] {
            width: 24px;
            height: 24px;
            cursor: pointer;
            margin: 0;
            flex-shrink: 0;
        }
        
        .form-group label:has(input[type="checkbox"]) {
            margin-bottom: 0;
        }
        
        /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ù„Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ */
        @media (min-width: 480px) {
            body {
                padding: 15px;
            }
            
            .form-group {
                min-width: calc(50% - 7.5px);
            }
            
            .options-grid {
                grid-template-columns: 1fr 1fr;
            }
            
            .center-buttons {
                flex-direction: row;
            }
            
            .center-buttons button {
                width: auto;
                flex: 1;
            }
        }
        
        @media (min-width: 768px) {
            body {
                padding: 20px;
            }
            
            .header {
                padding: 25px;
            }
            
            .header h1 {
                font-size: 28px;
            }
            
            .header p {
                font-size: 16px;
            }
            
            .tab {
                padding: 15px 25px;
                font-size: 16px;
            }
            
            .tab-content {
                padding: 30px;
            }
            
            .form-section {
                padding: 25px;
            }
            
            .form-section h3 {
                font-size: 20px;
            }
            
            .form-group {
                min-width: auto;
            }
            
            .question-text {
                font-size: 18px;
            }
            
            .score {
                font-size: 48px;
            }
            
            .grade {
                font-size: 24px;
            }
            
            .questions-grid {
                grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            }
        }
        
        @media (max-width: 479px) {
            .question-header {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .question-actions {
                width: 100%;
                justify-content: space-between;
            }
            
            .question-actions button {
                flex: 1;
                font-size: 14px;
                padding: 10px;
            }
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© ÙˆØ¨Ù†Ø§Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ© </h1>
            <p>Ø£Ø¯Ø§Ø© Ù…ØªÙƒØ§Ù…Ù„Ø© Ù„Ø¥Ù†Ø´Ø§Ø¡ ÙˆØ¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©</p>
        </div>
        
        <div class="tabs">
            <div class="tab active" data-tab="create">Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©</div>
            <div class="tab" data-tab="preview">Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ø£Ø³Ø¦Ù„Ø©</div>
            <div class="tab" data-tab="export">ØªØµØ¯ÙŠØ± Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</div>
        </div>
        
        <!-- ØªØ¨ÙˆÙŠØ¨ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© -->
        <div id="create" class="tab-content active">
            <div class="form-section">
                <h3>Ø¥Ø¶Ø§ÙØ© Ø³Ø¤Ø§Ù„ Ø¬Ø¯ÙŠØ¯</h3>
                <div id="form-alerts"></div>
                <div class="form-group">
                    <label for="question-text">Ù†Øµ Ø§Ù„Ø³Ø¤Ø§Ù„:</label>
                    <textarea id="question-text" placeholder="Ø£Ø¯Ø®Ù„ Ù†Øµ Ø§Ù„Ø³Ø¤Ø§Ù„ Ù‡Ù†Ø§..."></textarea>
                </div>
                
                <div class="form-group">
                    <label for="question-type">Ù†ÙˆØ¹ Ø§Ù„Ø³Ø¤Ø§Ù„:</label>
                    <select id="question-type">
                        <option value="mcq">Ø§Ø®ØªØ± Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø© (Ø®ÙŠØ§Ø±Ø§Øª Ù…ØªØ¹Ø¯Ø¯Ø©)</option>
                        <option value="tf">Ø³Ø¤Ø§Ù„ ØµØ­ / Ø®Ø·Ø£</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="question-points">Ø¯Ø±Ø¬Ø© Ø§Ù„Ø³Ø¤Ø§Ù„:</label>
                    <input type="number" id="question-points" placeholder="Ø£Ø¯Ø®Ù„ Ø¯Ø±Ø¬Ø© Ø§Ù„Ø³Ø¤Ø§Ù„" value="1" min="1" max="100">
                </div>
                
                <h4>Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©:</h4>
                <div id="mcq-options" class="options-grid">
                    <div class="form-group">
                        <label for="option1">Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„Ø£ÙˆÙ„:</label>
                        <input type="text" id="option1" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„Ø£ÙˆÙ„">
                    </div>
                    <div class="form-group">
                        <label for="option2">Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„Ø«Ø§Ù†ÙŠ:</label>
                        <input type="text" id="option2" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„Ø«Ø§Ù†ÙŠ">
                    </div>
                    <div class="form-group">
                        <label for="option3">Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„Ø«Ø§Ù„Ø«:</label>
                        <input type="text" id="option3" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„Ø«Ø§Ù„Ø«">
                    </div>
                    <div class="form-group">
                        <label for="option4">Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„Ø±Ø§Ø¨Ø¹:</label>
                        <input type="text" id="option4" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„Ø±Ø§Ø¨Ø¹">
                    </div>
                </div>
                
                <div class="form-group" id="mcq-correct-container">
                    <label for="correct-option">Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©:</label>
                    <select id="correct-option">
                        <option value="0">Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„Ø£ÙˆÙ„</option>
                        <option value="1">Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„Ø«Ø§Ù†ÙŠ</option>
                        <option value="2">Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„Ø«Ø§Ù„Ø«</option>
                        <option value="3">Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„Ø±Ø§Ø¨Ø¹</option>
                    </select>
                </div>
                
                <!-- Ø­Ù‚Ù„ Ø®Ø§Øµ Ø¨Ø³Ø¤Ø§Ù„ ØµØ­/Ø®Ø·Ø£ -->
                <div class="form-group" id="tf-correct-container" style="display: none;">
                    <label for="tf-correct">Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø© (Ù„Ø³Ø¤Ø§Ù„ ØµØ­/Ø®Ø·Ø£):</label>
                    <select id="tf-correct">
                        <option value="0">ØµØ­</option>
                        <option value="1">Ø®Ø·Ø£</option>
                    </select>
                </div>
                
                <div class="center-buttons">
                    <button id="add-question" class="btn-success">Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø³Ø¤Ø§Ù„</button>
                    <button id="clear-form" class="btn-warning">Ù…Ø³Ø­ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬</button>
                </div>
            </div>
            
            <div class="form-section">
                <h3>Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ù…Ø¶Ø§ÙØ© (Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©: <span id="questions-count">0</span>)</h3>
                <div id="questions-list">
                    <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡Ø§ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ -->
                </div>
            </div>
        </div>
        
        <!-- ØªØ¨ÙˆÙŠØ¨ Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ø£Ø³Ø¦Ù„Ø© -->
        <div id="preview" class="tab-content">
            <div class="form-section">
                <h3>Ù…Ø¹Ø§ÙŠÙ†Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© (Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©: <span id="preview-questions-count">0</span>)</h3>
                <div id="questions-preview">
                    <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡Ø§ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ -->
                </div>
            </div>
        </div>
        
        <!-- ØªØ¨ÙˆÙŠØ¨ ØªØµØ¯ÙŠØ± Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± -->
        <div id="export" class="tab-content">
            <div class="form-section">
                <h3>Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</h3>
                <div id="export-alerts"></div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="export-title">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±:</label>
                        <input type="text" id="export-title" placeholder="Ø£Ø¯Ø®Ù„ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±">
                    </div>
                    <div class="form-group">
                        <label for="export-subject">Ø§Ø³Ù… Ø§Ù„Ù…Ø§Ø¯Ø©:</label>
                        <input type="text" id="export-subject" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø§Ø¯Ø©">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="export-teacher">Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù…:</label>
                        <input type="text" id="export-teacher" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù…">
                    </div>
                    <div class="form-group">
                        <label for="export-time">Ù…Ø¯Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± (Ø¯Ù‚Ø§Ø¦Ù‚):</label>
                        <input type="number" id="export-time" placeholder="Ù…Ø¯Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±" value="60" min="1" max="180">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="export-total-score">Ø§Ù„Ø¯Ø±Ø¬Ø© Ø§Ù„ÙƒÙ„ÙŠØ©:</label>
                        <input type="number" id="export-total-score" placeholder="Ø§Ù„Ø¯Ø±Ø¬Ø© Ø§Ù„ÙƒÙ„ÙŠØ©" readonly>
                    </div>
                    <div class="form-group">
                        <label for="export-filename">Ø§Ø³Ù… Ø§Ù„Ù…Ù„Ù (Ø§Ø®ØªÙŠØ§Ø±ÙŠ):</label>
                        <input type="text" id="export-filename" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ù„Ù">
                    </div>
                </div>
                
                <div class="form-section" style="margin-top: 10px; background: #fff;">
                    <h3>Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="shuffle-questions">
                                Ø®Ù„Ø· ØªØ±ØªÙŠØ¨ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©
                            </label>
                        </div>
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="shuffle-options">
                                Ø®Ù„Ø· ØªØ±ØªÙŠØ¨ Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ø¯Ø§Ø®Ù„ ÙƒÙ„ Ø³Ø¤Ø§Ù„
                            </label>
                        </div>
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="prevent-back">
                                Ù…Ù†Ø¹ Ø§Ù„Ø±Ø¬ÙˆØ¹ Ø¥Ù„Ù‰ Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø³Ø§Ø¨Ù‚
                            </label>
                        </div>
                    </div>
                </div>
                
                <div class="center-buttons">
                    <button id="save-file-direct" class="btn-success">Ø­ÙØ¸ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ù…Ø¨Ø§Ø´Ø±Ø©</button>
                </div>
                
                <!-- ØªÙ… Ø¥Ø®ÙØ§Ø¡ ÙƒÙˆØ¯ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± ÙˆØ§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© Ù„ØªØ¨Ø³ÙŠØ· Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© -->
                <div id="export-code" style="display: none;"></div>

                <!-- ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ø¬Ù‡Ø© Ø§Ù„Ù…Ø§Ù„ÙƒØ© ÙÙŠ ØªØ¨ÙˆÙŠØ¨ Ø§Ù„ØªØµØ¯ÙŠØ± ÙÙ‚Ø· -->
                <div class="teacher-signature">
                    <div class="school-name">Ù…Ø¯Ø±Ø³Ø© Ø£Ø±ÙŠØ­Ø§</div>
                    <div class="school-message">Ø§Ù„Ø¹Ù„Ù… Ø³Ù„Ø§Ø­Ùƒ Ù„Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ØŒ ÙØ§Ø¬ØªÙ‡Ø¯ Ø§Ù„ÙŠÙˆÙ… Ù„ØªØµÙ†Ø¹ ØºØ¯Ùƒ Ø¨Ø¥Ø°Ù† Ø§Ù„Ù„Ù‡</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        let questions = [];
        
        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });
        
        function initializeApp() {
            try {
                // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©
                loadQuestionsFromStorage();
                
                // Ø¥Ø¹Ø¯Ø§Ø¯ Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª
                setupTabs();
                
                // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…Ø³ØªÙ…Ø¹ÙŠÙ† Ù„Ù„Ø£Ø­Ø¯Ø§Ø«
                setupEventListeners();
                
                // ØªØ­Ø¯ÙŠØ« Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©
                updateQuestionsCount();
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚:', error);
            }
        }
        
        function setupTabs() {
            const tabs = document.querySelectorAll('.tab');
            if (tabs.length === 0) {
                console.error('Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª');
                return;
            }
            
            tabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-tab');
                    if (!tabId) {
                        console.error('Ø§Ù„ØªØ¨ÙˆÙŠØ¨ Ù„Ø§ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ data-tab');
                        return;
                    }
                    
                    // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù†Ø´Ø§Ø· Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª
                    tabs.forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('.tab-content').forEach(content => {
                        content.classList.remove('active');
                    });
                    
                    // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù†Ø´Ø§Ø· Ù„Ù„ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ù…Ø­Ø¯Ø¯
                    this.classList.add('active');
                    const targetContent = document.getElementById(tabId);
                    if (targetContent) {
                        targetContent.classList.add('active');
                    } else {
                        console.error('Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØªØ¨ÙˆÙŠØ¨:', tabId);
                    }
                    
                    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„ØªØ¨ÙˆÙŠØ¨ Ù‡Ùˆ Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ø£Ø³Ø¦Ù„Ø©
                    if (tabId === 'preview') {
                        displayQuestionsPreview();
                    }
                    
                    // ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªØµØ¯ÙŠØ± Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„ØªØ¨ÙˆÙŠØ¨ Ù‡Ùˆ ØªØµØ¯ÙŠØ± Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±
                    if (tabId === 'export') {
                        updateExportFields();
                    }
                });
            });
        }
        
        function setupEventListeners() {
            // Ø²Ø± Ø¥Ø¶Ø§ÙØ© Ø³Ø¤Ø§Ù„
            const addBtn = document.getElementById('add-question');
            if (addBtn) {
                addBtn.addEventListener('click', addNewQuestion);
            }
            
            // Ø²Ø± Ù…Ø³Ø­ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
            const clearBtn = document.getElementById('clear-form');
            if (clearBtn) {
                clearBtn.addEventListener('click', clearQuestionForm);
            }
            
            // Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØµØ¯ÙŠØ±
            const saveDirectBtn = document.getElementById('save-file-direct');
            if (saveDirectBtn) {
                saveDirectBtn.addEventListener('click', saveFileDirect);
            }
            
            // Ø¥Ø¯Ø®Ø§Ù„ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„ØªØµØ¯ÙŠØ±
            document.getElementById('export-title').addEventListener('input', function() {
                const title = this.value.trim();
                if (title && !document.getElementById('export-filename').value) {
                    document.getElementById('export-filename').value = title.replace(/\s+/g, '_') + '.html';
                }
            });
            
            // ØªØºÙŠÙŠØ± ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø­Ø³Ø¨ Ù†ÙˆØ¹ Ø§Ù„Ø³Ø¤Ø§Ù„
            document.getElementById('question-type').addEventListener('change', function() {
                const type = this.value;
                const mcqOptions = document.getElementById('mcq-options');
                const mcqCorrect = document.getElementById('mcq-correct-container');
                const tfCorrect = document.getElementById('tf-correct-container');
                
                if (type === 'tf') {
                    // Ø¥Ø®ÙØ§Ø¡ Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…ØªØ¹Ø¯Ø¯ ÙˆØ¥Ø¸Ù‡Ø§Ø± ØµØ­/Ø®Ø·Ø£
                    mcqOptions.style.display = 'none';
                    mcqCorrect.style.display = 'none';
                    tfCorrect.style.display = 'block';
                } else {
                    // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…ØªØ¹Ø¯Ø¯ ÙˆØ¥Ø®ÙØ§Ø¡ ØµØ­/Ø®Ø·Ø£
                    mcqOptions.style.display = 'grid';
                    mcqCorrect.style.display = 'block';
                    tfCorrect.style.display = 'none';
                }
            });

            // ÙƒÙ„Ù…Ø© Ø³Ø± (Ø§Ø®ØªØµØ§Ø±): Alt + 8
            document.addEventListener('keydown', function(event) {
                if (event.altKey && (event.key === '8' || event.keyCode === 56)) {
                    event.preventDefault();
                    alert('Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø£Ø¨Ùˆ Ø§Ø¨Ø±Ø§Ù‡ÙŠÙ…');
                }
            });
        }
        
        function showAlert(containerId, message, type) {
            const container = document.getElementById(containerId);
            if (!container) {
                console.error('Ø¹Ù†ØµØ± Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯:', containerId);
                alert(message); // Ø§Ø³ØªØ®Ø¯Ø§Ù… alert ÙƒØ¨Ø¯ÙŠÙ„
                return;
            }
            
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert alert-${type}`;
            alertDiv.textContent = message;
            
            container.innerHTML = '';
            container.appendChild(alertDiv);
            
            // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¨Ø¹Ø¯ 5 Ø«ÙˆØ§Ù†ÙŠ
            setTimeout(() => {
                if (alertDiv.parentNode) {
                    alertDiv.remove();
                }
            }, 5000);
        }
        
        function addNewQuestion() {
            try {
                // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
                const questionData = getQuestionFormData();
                
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                if (!validateQuestionData(questionData)) {
                    return;
                }
                
                // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø³Ø¤Ø§Ù„ Ø¥Ù„Ù‰ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
                questions.push(questionData);
                
                // Ø­ÙØ¸ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ÙÙŠ Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ
                saveQuestionsToStorage();
                
                // ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
                displayQuestionsList();
                clearQuestionForm();
                updateQuestionsCount();
                
                showAlert('form-alerts', 'ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø³Ø¤Ø§Ù„ Ø¨Ù†Ø¬Ø§Ø­!', 'success');
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø³Ø¤Ø§Ù„:', error);
                showAlert('form-alerts', 'Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø³Ø¤Ø§Ù„. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.', 'error');
            }
        }
        
        function getQuestionFormData() {
            const questionTextEl = document.getElementById('question-text');
            const questionTypeEl = document.getElementById('question-type');
            const questionPointsEl = document.getElementById('question-points');
            
            if (!questionTextEl || !questionTypeEl || !questionPointsEl) {
                throw new Error('Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø©');
            }
            
            const questionText = questionTextEl.value.trim();
            const questionType = questionTypeEl.value;
            const questionPoints = parseInt(questionPointsEl.value) || 1;
            
            let options = [];
            let correctOptionIndex = 0;
            
            if (questionType === 'tf') {
                // Ø³Ø¤Ø§Ù„ ØµØ­/Ø®Ø·Ø£: Ø®ÙŠØ§Ø±Ø§Øª Ø«Ø§Ø¨ØªØ©
                const tfCorrectEl = document.getElementById('tf-correct');
                if (!tfCorrectEl) {
                    throw new Error('Ø¹Ù†ØµØ± tf-correct ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯');
                }
                options = ['ØµØ­', 'Ø®Ø·Ø£'];
                correctOptionIndex = parseInt(tfCorrectEl.value) || 0;
            } else {
                // Ø³Ø¤Ø§Ù„ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù† Ù…ØªØ¹Ø¯Ø¯ ÙƒÙ…Ø§ ÙÙŠ Ø§Ù„Ø³Ø§Ø¨Ù‚
                const option1El = document.getElementById('option1');
                const option2El = document.getElementById('option2');
                const option3El = document.getElementById('option3');
                const option4El = document.getElementById('option4');
                const correctOptionEl = document.getElementById('correct-option');
                
                if (!option1El || !option2El || !option3El || !option4El || !correctOptionEl) {
                    throw new Error('Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø©');
                }
                
                const option1 = option1El.value.trim();
                const option2 = option2El.value.trim();
                const option3 = option3El.value.trim();
                const option4 = option4El.value.trim();
                options = [option1, option2, option3, option4];
                correctOptionIndex = parseInt(correctOptionEl.value) || 0;
            }
            
            return {
                text: questionText,
                type: questionType,
                options: options,
                correctAnswer: correctOptionIndex,
                points: questionPoints
            };
        }
        
        function validateQuestionData(data) {
            if (!data.text) {
                showAlert('form-alerts', 'ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù†Øµ Ø§Ù„Ø³Ø¤Ø§Ù„', 'error');
                return false;
            }
            
            // ÙÙŠ Ø­Ø§Ù„Ø© Ø³Ø¤Ø§Ù„ ØµØ­/Ø®Ø·Ø£ Ù„Ø§ Ù†Ø­ØªØ§Ø¬ Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ù„Ø£Ù†Ù‡Ø§ Ø«Ø§Ø¨ØªØ©
            if (data.type !== 'tf') {
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Ù‡Ù†Ø§Ùƒ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„ Ø®ÙŠØ§Ø±ÙŠÙ† Ù…Ù…Ù„ÙˆØ¦ÙŠÙ†
                const filledOptions = data.options.filter(opt => opt.trim() !== '');
                if (filledOptions.length < 2) {
                    showAlert('form-alerts', 'ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„ Ø®ÙŠØ§Ø±ÙŠÙ† Ù„Ù„Ø¥Ø¬Ø§Ø¨Ø©', 'error');
                    return false;
                }
                
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„ØµØ­ÙŠØ­ Ù…Ù…Ù„ÙˆØ¡
                if (!data.options[data.correctAnswer] || data.options[data.correctAnswer].trim() === '') {
                    showAlert('form-alerts', 'Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„Ù…Ø­Ø¯Ø¯ ÙƒØ¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø© ÙØ§Ø±Øº', 'error');
                    return false;
                }
            }
            
            return true;
        }
        
        function displayQuestionsList() {
            const questionsList = document.getElementById('questions-list');
            if (!questionsList) {
                console.error('Ø¹Ù†ØµØ± questions-list ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯');
                return;
            }
            
            if (questions.length === 0) {
                questionsList.innerHTML = '<div class="empty-state"><i>ğŸ“</i><p>Ù„Ù… ØªØªÙ… Ø¥Ø¶Ø§ÙØ© Ø£ÙŠ Ø£Ø³Ø¦Ù„Ø© Ø¨Ø¹Ø¯</p></div>';
                return;
            }
            
            let html = '';
            questions.forEach((question, index) => {
                let optionsHTML = '';
                question.options.forEach((option, optIndex) => {
                    if (option.trim() === '') return;
                    
                    const isCorrect = optIndex === question.correctAnswer;
                    optionsHTML += `
                        <div class="quiz-option ${isCorrect ? 'correct-option' : ''}">
                            <span>${optIndex + 1}. ${option}</span>
                        </div>
                    `;
                });
                
                const typeLabel = question.type === 'tf' ? ' (ØµØ­ / Ø®Ø·Ø£)' : '';
                
                html += `
                    <div class="question-card">
                        <div class="question-header">
                            <h4>Ø§Ù„Ø³Ø¤Ø§Ù„ ${index + 1}${typeLabel} (${question.points} Ø¯Ø±Ø¬Ø©)</h4>
                            <div class="question-actions">
                                <button class="btn-warning" onclick="editQuestion(${index})">ØªØ¹Ø¯ÙŠÙ„</button>
                                <button class="btn-danger" onclick="deleteQuestion(${index})">Ø­Ø°Ù</button>
                            </div>
                        </div>
                        <div class="question-text">${question.text}</div>
                        <div class="options-list">
                            ${optionsHTML}
                        </div>
                    </div>
                `;
            });
            
            questionsList.innerHTML = html;
        }
        
        function clearQuestionForm() {
            document.getElementById('question-text').value = '';
            document.getElementById('question-points').value = '1';
            document.getElementById('option1').value = '';
            document.getElementById('option2').value = '';
            document.getElementById('option3').value = '';
            document.getElementById('option4').value = '';
            document.getElementById('correct-option').value = '0';
            document.getElementById('form-alerts').innerHTML = '';
        }
        
        // Ø¬Ø¹Ù„ Ø§Ù„Ø¯ÙˆØ§Ù„ Ù…ØªØ§Ø­Ø© ÙÙŠ Ø§Ù„Ù†Ø·Ø§Ù‚ Ø§Ù„Ø¹Ø§Ù… Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙÙŠ onclick
        window.deleteQuestion = function(index) {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø³Ø¤Ø§Ù„ØŸ')) {
                questions.splice(index, 1);
                saveQuestionsToStorage();
                displayQuestionsList();
                updateQuestionsCount();
            }
        };
        
        window.editQuestion = function(index) {
            const question = questions[index];
            
            // ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø¨Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø³Ø¤Ø§Ù„
            document.getElementById('question-text').value = question.text;
            document.getElementById('question-type').value = question.type || 'mcq';
            document.getElementById('question-points').value = question.points;
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø­Ø³Ø¨ Ù†ÙˆØ¹ Ø§Ù„Ø³Ø¤Ø§Ù„
            const typeSelect = document.getElementById('question-type');
            const event = new Event('change');
            typeSelect.dispatchEvent(event);
            
            if ((question.type || 'mcq') === 'tf') {
                // Ø³Ø¤Ø§Ù„ ØµØ­/Ø®Ø·Ø£
                document.getElementById('tf-correct').value = String(question.correctAnswer || 0);
                // ØªÙØ±ÙŠØº Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ù„Ø£Ù†Ù†Ø§ Ù„Ø§ Ù†Ø³ØªØ®Ø¯Ù…Ù‡Ø§ Ù‡Ù†Ø§
                document.getElementById('option1').value = '';
                document.getElementById('option2').value = '';
                document.getElementById('option3').value = '';
                document.getElementById('option4').value = '';
                document.getElementById('correct-option').value = '0';
            } else {
                // Ø³Ø¤Ø§Ù„ Ø§Ø®ØªÙŠØ§Ø± Ù…Ù† Ù…ØªØ¹Ø¯Ø¯
                document.getElementById('option1').value = question.options[0] || '';
                document.getElementById('option2').value = question.options[1] || '';
                document.getElementById('option3').value = question.options[2] || '';
                document.getElementById('option4').value = question.options[3] || '';
                document.getElementById('correct-option').value = String(question.correctAnswer || 0);
                document.getElementById('tf-correct').value = '0';
            }
            
            // Ø­Ø°Ù Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ù‚Ø¯ÙŠÙ…
            questions.splice(index, 1);
            saveQuestionsToStorage();
            displayQuestionsList();
            updateQuestionsCount();
            
            // Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„Ù‰ ØªØ¨ÙˆÙŠØ¨ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©
            switchToTab('create');
            
            showAlert('form-alerts', 'ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø³Ø¤Ø§Ù„', 'success');
        };
        
        function switchToTab(tabName) {
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            document.querySelector(`.tab[data-tab="${tabName}"]`).classList.add('active');
            document.getElementById(tabName).classList.add('active');
        }
        
        function displayQuestionsPreview() {
            const previewContainer = document.getElementById('questions-preview');
            document.getElementById('preview-questions-count').textContent = questions.length;
            
            if (questions.length === 0) {
                previewContainer.innerHTML = '<div class="empty-state"><i>ğŸ“</i><p>Ù„Ù… ØªØªÙ… Ø¥Ø¶Ø§ÙØ© Ø£ÙŠ Ø£Ø³Ø¦Ù„Ø© Ø¨Ø¹Ø¯</p></div>';
                return;
            }
            
            let html = '<div class="questions-grid">';
            
            questions.forEach((question, index) => {
                let optionsHTML = '';
                question.options.forEach((option, optIndex) => {
                    if (option.trim() === '') return;
                    
                    const isCorrect = optIndex === question.correctAnswer;
                    optionsHTML += `
                        <div class="quiz-option ${isCorrect ? 'correct-option' : ''}">
                            <span>${optIndex + 1}. ${option}</span>
                        </div>
                    `;
                });
                
                const typeLabel = question.type === 'tf' ? ' (ØµØ­ / Ø®Ø·Ø£)' : '';
                
                html += `
                    <div class="preview-card">
                        <h4>Ø§Ù„Ø³Ø¤Ø§Ù„ ${index + 1}${typeLabel}</h4>
                        <div class="question-text">${question.text}</div>
                        <div class="options-list">
                            ${optionsHTML}
                        </div>
                        <div style="margin-top: 10px; color: #7f8c8d; font-size: 14px;">
                            Ø§Ù„Ø¯Ø±Ø¬Ø©: ${question.points}
                        </div>
                    </div>
                `;
            });
            
            html += '</div>';
            previewContainer.innerHTML = html;
        }
        
        function updateQuestionsCount() {
            document.getElementById('questions-count').textContent = questions.length;
            document.getElementById('preview-questions-count').textContent = questions.length;
        }
        
        function updateExportFields() {
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¯Ø±Ø¬Ø© Ø§Ù„ÙƒÙ„ÙŠØ© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
            const totalScore = calculateTotalScore();
            document.getElementById('export-total-score').value = totalScore;
            
            // Ø§Ù‚ØªØ±Ø§Ø­ Ø¹Ù†ÙˆØ§Ù† Ø§ÙØªØ±Ø§Ø¶ÙŠ
            if (!document.getElementById('export-title').value) {
                document.getElementById('export-title').value = 'Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙŠØ©';
            }
        }
        
        function generateExportCode() {
            if (questions.length === 0) {
                showAlert('export-alerts', 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø³Ø¦Ù„Ø© Ù„ØªØµØ¯ÙŠØ±Ù‡Ø§', 'error');
                return;
            }
            
            const title = document.getElementById('export-title').value || 'Ø­Ø¯Ø¯ Ø§Ø³Ù… Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±';
            const subject = document.getElementById('export-subject').value || 'Ø­Ø¯Ø¯ Ø§Ø³Ù… Ø§Ù„Ù…Ø§Ø¯Ø©';
            const teacher = document.getElementById('export-teacher').value || 'Ø­Ø¯Ø¯ Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù…';
            const totalScore = document.getElementById('export-total-score').value || calculateTotalScore();
            const time = document.getElementById('export-time').value || '60';
            
            const shuffleQuestionsSetting = document.getElementById('shuffle-questions').checked;
            const shuffleOptionsSetting = document.getElementById('shuffle-options').checked;
            const preventBackSetting = document.getElementById('prevent-back').checked;
            
            let questionsCode = '';
            questions.forEach((question, index) => {
                // ØªØµÙÙŠØ© Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„ÙØ§Ø±ØºØ©
                const filteredOptions = question.options.filter(opt => opt.trim() !== '');
                const qType = question.type || 'mcq';
                
                questionsCode += `
        {
            text: "${question.text.replace(/"/g, '\\"')}",
            type: "${qType}",
            options: [${filteredOptions.map(opt => `"${opt.replace(/"/g, '\\"')}"`).join(",")}],
            correctAnswer: ${question.correctAnswer},
            points: ${question.points}
        }${index < questions.length - 1 ? ',' : ''}`;
            });
            
            const exportCode = generateExportCodeContent(title, subject, teacher, totalScore, time, shuffleQuestionsSetting, shuffleOptionsSetting, preventBackSetting, questionsCode);
            
            document.getElementById('export-code').textContent = exportCode;
            showAlert('export-alerts', 'ØªÙ… ØªÙˆÙ„ÙŠØ¯ ÙƒÙˆØ¯ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø¨Ù†Ø¬Ø§Ø­!', 'success');
        }
        
        function generateExportCodeContent(title, subject, teacher, totalScore, time, shuffleQuestionsSetting, shuffleOptionsSetting, preventBackSetting, questionsCode) {
            return `<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>${title}</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f5f7fa;
            margin: 0;
            padding: 20px;
            line-height: 1.6;
            position: relative;
            padding-bottom: 80px;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        .header {
            background: #2c3e50;
            color: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            margin-bottom: 25px;
        }
        .header h1 {
            margin-bottom: 10px;
        }
        .header-info {
            display: flex;
            justify-content: space-between;
            margin-top: 15px;
            flex-wrap: wrap;
        }
        .info-item {
            margin: 5px 10px;
        }
        .student-form {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 25px;
        }
        .form-row {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
        }
        .form-group {
            flex: 1;
        }
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        .form-group input, .form-group select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .alert {
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            font-weight: bold;
            display: none;
        }
        .alert-error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .question {
            margin-bottom: 25px;
            padding: 20px;
            border: 1px solid #e1e8ed;
            border-radius: 8px;
            background: #f8f9fa;
        }
        .options {
            margin-top: 15px;
        }
        .option {
            margin: 10px 0;
            padding: 12px;
            background: white;
            border: 1px solid #ddd;
            border-radius: 5px;
            cursor: pointer;
            display: flex;
            align-items: center;
        }
        .option:hover {
            background: #e8f4fc;
        }
        .option input {
            margin-left: 10px;
        }
        button {
            background: #3498db;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
        }
        button:hover {
            background: #2980b9;
        }
        .timer {
            font-size: 18px;
            font-weight: bold;
            color: #e74c3c;
            text-align: center;
            margin: 15px 0;
            padding: 10px;
            background: #fff;
            border-radius: 5px;
            border: 2px solid #e74c3c;
        }
        .score-card {
            background: linear-gradient(135deg, #1a5276 0%, #154360 100%);
            color: white;
            padding: 30px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
        }
        .score {
            font-size: 48px;
            font-weight: bold;
            margin: 15px 0;
        }
        .grade {
            font-size: 24px;
            margin: 10px 0;
        }
        .student-info {
            font-size: 18px;
            margin: 10px 0;
            color: #f1c40f;
        }
        .teacher-signature {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            border-radius: 15px;
            font-size: 16px;
            color: white;
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
            text-align: center;
            line-height: 1.6;
            margin: 20px auto;
            width: 100%;
            max-width: 100%;
            position: relative;
            overflow: hidden;
        }
        .teacher-signature::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: shimmer 3s infinite;
        }
        @keyframes shimmer {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .teacher-signature .school-name {
            font-size: 22px;
            font-weight: bold;
            margin-bottom: 10px;
            position: relative;
            z-index: 1;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
            letter-spacing: 1px;
        }
        .teacher-signature .school-message {
            font-size: 14px;
            opacity: 0.95;
            position: relative;
            z-index: 1;
            line-height: 1.8;
            font-style: italic;
        }
        @media (max-width: 768px) {
            .form-row {
                flex-direction: column;
            }
            .header-info {
                flex-direction: column;
                align-items: center;
            }
            .teacher-signature {
                padding: 18px 15px;
            }
            .teacher-signature .school-name {
                font-size: 20px;
            }
            .teacher-signature .school-message {
                font-size: 13px;
            }
            body {
                padding-bottom: 20px;
            }
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"><\/script>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>${title}</h1>
            <div class="header-info">
                <div class="info-item">Ø§Ù„Ù…Ø§Ø¯Ø©: ${subject}</div>
                <div class="info-item">Ø§Ù„Ù…Ø¹Ù„Ù…: ${teacher}</div>
                <div class="info-item">Ø§Ù„Ø¯Ø±Ø¬Ø© Ø§Ù„ÙƒÙ„ÙŠØ©: ${totalScore}</div>
                <div class="info-item">Ø§Ù„ÙˆÙ‚Øª: ${time} Ø¯Ù‚ÙŠÙ‚Ø©</div>
            </div>
            <div class="timer" id="timer"></div>
        </div>
        
        <div id="student-form" class="student-form">
            <h3>Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨</h3>
            <div id="student-alert" class="alert alert-error"></div>
            <div class="form-row">
                <div class="form-group">
                    <label for="student-name">Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„:</label>
                    <input type="text" id="student-name" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ Ø§Ù„ÙƒØ§Ù…Ù„">
                </div>
                <div class="form-group">
                    <label for="student-class">Ø§Ù„ØµÙ:</label>
                    <input type="text" id="student-class" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„ØµÙ">
                </div>
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label for="student-section">Ø§Ù„Ø´Ø¹Ø¨Ø©:</label>
                    <input type="text" id="student-section" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø´Ø¹Ø¨Ø©">
                </div>
            </div>
            <div style="text-align: center;">
                <button id="start-btn">Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</button>
            </div>
        </div>
        
        <div id="quiz-container" style="display: none;"></div>
        
        <div style="text-align: center; margin-top: 25px;">
            <button id="submit-btn" style="display: none;">ØªØ³Ù„ÙŠÙ… Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</button>
        </div>
        
        <div id="results" style="display: none;"></div>
    </div>

    <!-- ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ø¬Ù‡Ø© Ø§Ù„Ù…Ø§Ù„ÙƒØ© ÙÙŠ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± ÙÙ‚Ø· -->
    <div class="teacher-signature">
        <div class="school-name"> Ù…Ø¯Ø±Ø³Ø© Ø£Ø±ÙŠØ­Ø§</div>
        <div class="school-message">Ø§Ù„Ø¹Ù„Ù… Ø³Ù„Ø§Ø­Ùƒ Ù„Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ØŒ ÙØ§Ø¬ØªÙ‡Ø¯ Ø§Ù„ÙŠÙˆÙ… Ù„ØªØµÙ†Ø¹ ØºØ¯Ùƒ Ø¨Ø¥Ø°Ù† Ø§Ù„Ù„Ù‡</div>
    </div>

    <script>
        const quizTitle = "${title}";
        const shuffleQuestions = ${shuffleQuestionsSetting ? 'true' : 'false'};
        const shuffleOptions = ${shuffleOptionsSetting ? 'true' : 'false'};
        const preventBack = ${preventBackSetting ? 'true' : 'false'};
        const questions = [${questionsCode}];
        
        let questionOrder = questions.map((_, index) => index);
        if (shuffleQuestions) {
            questionOrder.sort(() => Math.random() - 0.5);
        }
        
        let currentQuestionPos = 0;
        let userAnswers = new Array(questions.length).fill(null);
        let timer;
        let timeLeft = ${time} * 60;
        let studentName = '';
        let studentClass = '';
        let studentSection = '';
        
        function showStudentAlert(message) {
            const alertDiv = document.getElementById('student-alert');
            alertDiv.textContent = message;
            alertDiv.style.display = 'block';
            
            setTimeout(() => {
                alertDiv.style.display = 'none';
            }, 5000);
        }

        // ÙƒÙ„Ù…Ø© Ø³Ø± (Ø§Ø®ØªØµØ§Ø±): Alt + 8
        document.addEventListener('keydown', function(event) {
            if (event.altKey && (event.key === '8' || event.keyCode === 56)) {
                event.preventDefault();
                alert('ÙØ±ÙŠÙ‚ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙŠØ© Ù…Ø¹ÙƒÙ…');
            }
        });
        
        function startQuiz() {
            studentName = document.getElementById('student-name').value.trim();
            studentClass = document.getElementById('student-class').value.trim();
            studentSection = document.getElementById('student-section').value.trim();
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            if (!studentName) {
                showStudentAlert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„');
                document.getElementById('student-name').focus();
                return;
            }
            
            if (!studentClass) {
                showStudentAlert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„ØµÙ');
                document.getElementById('student-class').focus();
                return;
            }
            
            if (!studentSection) {
                showStudentAlert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø´Ø¹Ø¨Ø©');
                document.getElementById('student-section').focus();
                return;
            }
            
            // Ø¥Ø®ÙØ§Ø¡ Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø·Ø§Ù„Ø¨ ÙˆØ¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±
            document.getElementById('student-form').style.display = 'none';
            document.getElementById('quiz-container').style.display = 'block';
            document.getElementById('submit-btn').style.display = 'block';
            
            currentQuestionPos = 0;
            displayQuestion(currentQuestionPos);
            startTimer();
        }
        
        function displayQuestion(orderPosition) {
            const quizContainer = document.getElementById('quiz-container');
            const realIndex = questionOrder[orderPosition];
            const question = questions[realIndex];
            
            let optionsHTML = '';
            let optionIndices = question.options.map((_, i) => i);
            if (shuffleOptions) {
                optionIndices.sort(() => Math.random() - 0.5);
            }
            
            optionIndices.forEach((optIndex) => {
                const option = question.options[optIndex];
                const isChecked = userAnswers[realIndex] === optIndex ? 'checked' : '';
                optionsHTML += '<div class="option">' +
                    '<input type="radio" id="opt' + realIndex + '_' + optIndex + '" name="answer' + realIndex + '" value="' + optIndex + '" ' + isChecked + ' onchange="userAnswers[' + realIndex + '] = ' + optIndex + '">' +
                    '<label for="opt' + realIndex + '_' + optIndex + '">' + option + '</label>' +
                    '</div>';
            });
            
            const questionHTML = '<div class="question">' +
                '<h3>Ø§Ù„Ø³Ø¤Ø§Ù„ ' + (orderPosition + 1) + '</h3>' +
                '<p>' + question.text + '</p>' +
                '<div class="options">' +
                optionsHTML +
                '</div>' +
                '</div>' +
                '<div style="text-align: center; margin-top: 20px;">' +
                (orderPosition > 0 && !preventBack ? '<button onclick="prevQuestion()">Ø§Ù„Ø³Ø§Ø¨Ù‚</button>' : '') +
                (orderPosition < questionOrder.length - 1 ? '<button onclick="nextQuestion()">Ø§Ù„ØªØ§Ù„ÙŠ</button>' : '') +
                '</div>';
            
            quizContainer.innerHTML = questionHTML;
        }
        
        function nextQuestion() {
            if (currentQuestionPos < questionOrder.length - 1) {
                currentQuestionPos++;
                displayQuestion(currentQuestionPos);
            }
        }
        
        function prevQuestion() {
            if (preventBack) return;
            if (currentQuestionPos > 0) {
                currentQuestionPos--;
                displayQuestion(currentQuestionPos);
            }
        }
        
        function startTimer() {
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø±Ø¶ Ø£ÙˆÙ„Ø§Ù‹
            updateTimerDisplay();
            
            timer = setInterval(function() {
                timeLeft--;
                updateTimerDisplay();
                
                if (timeLeft <= 0) {
                    clearInterval(timer);
                    submitQuiz();
                }
            }, 1000);
        }
        
        function updateTimerDisplay() {
            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;
            document.getElementById('timer').textContent = 'Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ: ' + minutes + ':' + (seconds < 10 ? '0' : '') + seconds;
        }
        
        function submitQuiz() {
            clearInterval(timer);
            
            let score = 0;
            let totalScore = 0;
            
            questions.forEach((question, index) => {
                totalScore += question.points;
                if (userAnswers[index] === question.correctAnswer) {
                    score += question.points;
                }
            });
            
            const percentage = (score / totalScore) * 100;
            
            let grade = '';
            let encourageMessage = '';
            if (percentage >= 90) {
                grade = 'Ù…Ù…ØªØ§Ø²';
                encourageMessage = 'Ø£Ø¯Ø§Ø¡ Ø±Ø§Ø¦Ø¹ Ø¬Ø¯Ù‹Ø§! Ø§Ø³ØªÙ…Ø± Ø¹Ù„Ù‰ Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ù…Ù…ÙŠØ² ğŸ‘';
            } else if (percentage >= 80) {
                grade = 'Ø¬ÙŠØ¯ Ø¬Ø¯Ù‹Ø§';
                encourageMessage = 'Ù†ØªÙŠØ¬Ø© Ù…Ù…ØªØ§Ø²Ø©ØŒ ÙˆÙ…Ø¹ Ù‚Ù„ÙŠÙ„ Ù…Ù† Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© Ø³ØªØµÙ„ Ø¥Ù„Ù‰ Ø§Ù„ÙƒÙ…Ø§Ù„ ğŸŒŸ';
            } else if (percentage >= 70) {
                grade = 'Ø¬ÙŠØ¯';
                encourageMessage = 'Ù†ØªÙŠØ¬Ø© Ø¬ÙŠØ¯Ø©ØŒ Ø­Ø§ÙˆÙ„ Ø§Ù„ØªØ±ÙƒÙŠØ² Ø¹Ù„Ù‰ Ù†Ù‚Ø§Ø· Ø§Ù„Ø¶Ø¹Ù Ù„Ù„Ù…Ø±Ø© Ø§Ù„Ù‚Ø§Ø¯Ù…Ø© ğŸ‘';
            } else if (percentage >= 60) {
                grade = 'Ù…Ù‚Ø¨ÙˆÙ„';
                encourageMessage = 'Ù…Ø³ØªÙˆÙ‰ Ù…Ù‚Ø¨ÙˆÙ„ØŒ ØªØ­ØªØ§Ø¬ Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„ØªØ¯Ø±ÙŠØ¨ ÙˆØ§Ù„Ø§Ø¬ØªÙ‡Ø§Ø¯ ğŸ’ª';
            } else {
                grade = 'Ø¶Ø¹ÙŠÙ';
                encourageMessage = 'Ù„Ø§ Ø¨Ø£Ø³ØŒ Ø§Ø¹ØªØ¨Ø± Ù‡Ø°Ø§ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± ØªØ¬Ø±Ø¨Ø© ÙˆØªØ¹Ù„Ù‘Ù… Ù…Ù† Ø£Ø®Ø·Ø§Ø¦Ùƒ Ù„Ù„Ù…Ø±Ø© Ø§Ù„Ù‚Ø§Ø¯Ù…Ø© ğŸ˜Š';
            }
            
            let resultsHTML = '<div id="result-card" class="score-card">' +
                '<h2>Ù†ØªÙŠØ¬Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</h2>' +
                '<div class="score">' + score + '/' + totalScore + '</div>' +
                '<div class="grade">' + Math.round(percentage) + '% - ' + grade + '</div>' +
                '<div class="student-info">Ø§Ù„Ø·Ø§Ù„Ø¨: ' + studentName + '</div>' +
                '<div class="student-info">Ø§Ù„ØµÙ: ' + studentClass + ' - Ø§Ù„Ø´Ø¹Ø¨Ø©: ' + studentSection + '</div>' +
                '<div style="margin-top: 15px; font-size: 16px;">' + encourageMessage + '</div>' +
                '</div>' +
                '<div style="margin-top: 20px; text-align: center;">' +
                '<button onclick="downloadResultAsImage()">ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†ØªÙŠØ¬Ø© ÙƒØµÙˆØ±Ø©</button>' +
                '<button onclick="shareOnWhatsApp()">Ù…Ø´Ø§Ø±ÙƒØ© Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨</button>' +
                '</div>';
            
            // Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø£Ø®Ø·Ø§Ø¡
            let reviewHTML = '<div style="margin-top: 30px;">' +
                '<h3>Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ÙˆØ§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª</h3>';
            
            questions.forEach((question, index) => {
                const userAnswerIndex = userAnswers[index];
                const isCorrect = userAnswerIndex === question.correctAnswer;
                const correctText = question.options[question.correctAnswer] || '';
                const userText = userAnswerIndex !== null && userAnswerIndex !== undefined
                    ? (question.options[userAnswerIndex] || '')
                    : 'Ù„Ù… ÙŠØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø¥Ø¬Ø§Ø¨Ø©';
                
                reviewHTML += '<div class="question" style="margin-top: 15px; border-color:' + (isCorrect ? '#2ecc71' : '#e74c3c') + ';">' +
                    '<h4>Ø§Ù„Ø³Ø¤Ø§Ù„ ' + (index + 1) + '</h4>' +
                    '<p>' + question.text + '</p>' +
                    '<p style="margin-top: 8px;"><strong>Ø¥Ø¬Ø§Ø¨ØªÙƒ:</strong> ' +
                    '<span style="color:' + (isCorrect ? '#2ecc71' : '#e74c3c') + ';">' + userText + '</span></p>' +
                    '<p><strong>Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©:</strong> <span>' + correctText + '</span></p>' +
                    '</div>';
            });
            
            reviewHTML += '</div>';
            
            const resultsContainer = document.getElementById('results');
            resultsContainer.innerHTML = resultsHTML + reviewHTML;
            resultsContainer.style.display = 'block';
            
            document.getElementById('quiz-container').style.display = 'none';
            document.getElementById('submit-btn').style.display = 'none';
        }
        
        function downloadResultAsImage() {
            const card = document.getElementById('result-card');
            if (!card) return;
            
            html2canvas(card).then(canvas => {
                const link = document.createElement('a');
                link.href = canvas.toDataURL('image/png');
                link.download = 'Ù†ØªÙŠØ¬Ø©_Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±_' + (studentName || 'Ø·Ø§Ù„Ø¨') + '.png';
                link.click();
            });
        }
        
        function shareOnWhatsApp() {
            let score = 0;
            let totalScore = 0;
            
            questions.forEach((question, index) => {
                totalScore += question.points;
                if (userAnswers[index] === question.correctAnswer) {
                    score += question.points;
                }
            });
            
            const percentage = totalScore > 0 ? Math.round((score / totalScore) * 100) : 0;
            const name = studentName || 'Ø¨Ø¯ÙˆÙ† Ø§Ø³Ù…';
            
            const text =
                'Ù†ØªÙŠØ¬ØªÙŠ ÙÙŠ Ø§Ø®ØªØ¨Ø§Ø± "' + quizTitle + '"\\n' +
                'Ø§Ù„Ø·Ø§Ù„Ø¨: ' + name + '\\n' +
                'Ø§Ù„Ù†ØªÙŠØ¬Ø©: ' + score + '/' + totalScore + ' (' + percentage + '%)' + '\\n' +
                'ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù‡Ø°Ø§ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø¨ÙˆØ§Ø³Ø·Ø© Ù…Ù†Ø´Ø¦ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª.';
            
            const url = 'https://wa.me/?text=' + encodeURIComponent(text);
            window.open(url, '_blank');
        }
        
        // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ÙŠ Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
        document.addEventListener('DOMContentLoaded', function() {
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø¯Ø§Ø¯ Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
            updateTimerDisplay();
            
            document.getElementById('start-btn').addEventListener('click', startQuiz);
            document.getElementById('submit-btn').addEventListener('click', submitQuiz);
        });
    <\/script>
</body>
</html>`;
        }
        
        function copyExportCode() {
            const codeText = document.getElementById('export-code').textContent;
            if (!codeText || codeText.trim() === '' || codeText.includes('Ø³ÙŠØªÙ… Ø¹Ø±Ø¶ ÙƒÙˆØ¯ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ù‡Ù†Ø§')) {
                showAlert('export-alerts', 'ÙŠØ±Ø¬Ù‰ ØªÙˆÙ„ÙŠØ¯ ÙƒÙˆØ¯ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø£ÙˆÙ„Ø§Ù‹!', 'error');
                return;
            }
            
            navigator.clipboard.writeText(codeText).then(function() {
                showAlert('export-alerts', 'ØªÙ… Ù†Ø³Ø® ÙƒÙˆØ¯ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø§ÙØ¸Ø©!', 'success');
            }, function(err) {
                console.error('ÙØ´Ù„ ÙÙŠ Ù†Ø³Ø® Ø§Ù„Ù†Øµ: ', err);
                showAlert('export-alerts', 'ÙØ´Ù„ ÙÙŠ Ù†Ø³Ø® Ø§Ù„ÙƒÙˆØ¯. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.', 'error');
            });
        }
        
        function saveQuizFile() {
            // ØªÙˆÙ„ÙŠØ¯ Ø§Ù„ÙƒÙˆØ¯ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù…ÙˆØ¬ÙˆØ¯Ø§Ù‹
            const codeText = document.getElementById('export-code').textContent;
            if (!codeText || codeText.trim() === '' || codeText.includes('Ø³ÙŠØªÙ… Ø¹Ø±Ø¶ ÙƒÙˆØ¯ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ù‡Ù†Ø§')) {
                generateExportCode();
                // Ø§Ù†ØªØ¸Ø§Ø± Ù‚Ù„ÙŠÙ„ Ø«Ù… Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰
                setTimeout(() => {
                    saveQuizFile();
                }, 500);
                return;
            }
            
            let filename = document.getElementById('export-filename').value.trim();
            if (!filename) {
                const testTitle = document.getElementById('export-title').value || '';
                filename = testTitle.replace(/\s+/g, '_') + '.html';
            } else {
                if (!filename.endsWith('.html')) {
                    filename += '.html';
                }
            }
            
            const blob = new Blob([codeText], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            
            setTimeout(() => {
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }, 100);
            
            showAlert('export-alerts', 'ØªÙ… Ø­ÙØ¸ Ù…Ù„Ù Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø¨Ø§Ø³Ù…: ' + filename, 'success');
        }
        
        function saveFileDirect() {
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø£Ø³Ø¦Ù„Ø©
            if (questions.length === 0) {
                showAlert('export-alerts', 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø³Ø¦Ù„Ø© Ù„ØªØµØ¯ÙŠØ±Ù‡Ø§', 'error');
                return;
            }
            
            // ØªÙˆÙ„ÙŠØ¯ Ø§Ù„ÙƒÙˆØ¯ Ù…Ø¨Ø§Ø´Ø±Ø©  Ø¹Ø±Ø¶Ù‡
            const title = document.getElementById('export-title').value || '';
            const subject = document.getElementById('export-subject').value || '';
            const teacher = document.getElementById('export-teacher').value || 'Ø§Ù„Ù…Ø¹Ù„Ù…';
            const totalScore = document.getElementById('export-total-score').value || calculateTotalScore();
            const time = document.getElementById('export-time').value || '60';
            
            const shuffleQuestionsSetting = document.getElementById('shuffle-questions').checked;
            const shuffleOptionsSetting = document.getElementById('shuffle-options').checked;
            const preventBackSetting = document.getElementById('prevent-back').checked;
            
            let questionsCode = '';
            questions.forEach((question, index) => {
                const filteredOptions = question.options.filter(opt => opt.trim() !== '');
                const qType = question.type || 'mcq';
                
                questionsCode += `
        {
            text: "${question.text.replace(/"/g, '\\"')}",
            type: "${qType}",
            options: [${filteredOptions.map(opt => `"${opt.replace(/"/g, '\\"')}"`).join(",")}],
            correctAnswer: ${question.correctAnswer},
            points: ${question.points}
        }${index < questions.length - 1 ? ',' : ''}`;
            });
            
            // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù†ÙØ³ ÙƒÙˆØ¯ Ø§Ù„ØªÙˆÙ„ÙŠØ¯ Ù…Ù† generateExportCode
            const exportCode = generateExportCodeContent(title, subject, teacher, totalScore, time, shuffleQuestionsSetting, shuffleOptionsSetting, preventBackSetting, questionsCode);
            
            // Ø­ÙØ¸ Ø§Ù„Ù…Ù„Ù Ù…Ø¨Ø§Ø´Ø±Ø©
            let filename = document.getElementById('export-filename').value.trim();
            if (!filename) {
                filename = title.replace(/\s+/g, '_') + '.html';
            } else {
                if (!filename.endsWith('.html')) {
                    filename += '.html';
                }
            }
            
            const blob = new Blob([exportCode], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            
            setTimeout(() => {
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }, 100);
            
            showAlert('export-alerts', 'ØªÙ… Ø­ÙØ¸ Ù…Ù„Ù Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ù…Ø¨Ø§Ø´Ø±Ø© Ø¨Ø§Ø³Ù…: ' + filename, 'success');
        }
        
        function calculateTotalScore() {
            return questions.reduce((total, question) => total + question.points, 0);
        }
        
        function saveQuestionsToStorage() {
            localStorage.setItem('ictQuizQuestions', JSON.stringify(questions));
        }
        
        function loadQuestionsFromStorage() {
            const savedQuestions = localStorage.getItem('ictQuizQuestions');
            if (savedQuestions) {
                try {
                    questions = JSON.parse(savedQuestions);
                    displayQuestionsList();
                } catch (e) {
                    console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©:', e);
                    questions = [];
                }
            }
        }
    </script>
</body>
</html>